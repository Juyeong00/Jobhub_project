<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
					"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
					
<mapper namespace="user_mapper">
	
	
	<select id="findLoginCustomer" parameterType="Customer" resultType="Customer">
		SELECT * FROM job_customer WHERE user_id=#{userId} and password=#{password}
	</select>

	<select id="findCustomerInfo" parameterType="String" resultType="Customer">
		SELECT * FROM job_customer WHERE user_id = #{userId}
	</select>
	
	<update id="modifyCustomerInfo" parameterType="Customer">
		UPDATE job_customer
		SET name = #{name} ,
			birth = #{birth},
			phone = #{phone}
		WHERE user_id = #{userId}
	</update>
	
	<update id="modifyCustomerPw" parameterType="Customer">
		UPDATE job_customer
		SET password = #{password}
		WHERE user_id = #{userId}
	</update>
	
	<update id="removeCustomer" parameterType="Customer">
		UPDATE job_customer
		SET customer_status = #{customerStatus}
		WHERE user_id = #{userId}
	</update>
	
	<select id="findCustomerListBySearchCondition" resultType="Customer" parameterType="CustomerSearchCondition">
		SELECT *
		FROM job_customer
		WHERE 1=1
		<if test="searchKeyword != null and !searchKeyword.isEmpty()">
		<choose>
			<when test="sfl == 'userId'">
				AND user_id LIKE '%' || #{searchKeyword} || '%'
			</when>
			<when test="sfl == 'email'">
				AND email = #{searchKeyword}
			</when>
			<when test="sfl == 'name'">
				AND name LIKE '%' || #{searchKeyword} || '%'
			</when>
			<when test="sfl == 'phone'">
				AND phone LIKE '%' || #{searchKeyword} || '%'
			</when>
		</choose>
	</if>
		<!-- 가입기간 조회 -->
		<if test="spt == 'createdDate'">
			<if test="startDate != null and startDate != ''">
				<![CDATA[AND TO_DATE(created_date, 'YYYY-MM-DD') >= TO_DATE(#{startDate}, 'YYYY-MM-DD')]]>
			</if>
			<if test="endDate != null and endDate != ''">
				<![CDATA[AND TO_DATE(created_date, 'YYYY-MM-DD') <= TO_DATE(#{endDate},
			'YYYY-MM-DD')]]>
			</if>
		</if>
		<if test="spt == 'birth'">
			<if test="startDate != null and startDate != ''">
			<![CDATA[AND TO_DATE(birth, 'YYYY-MM-DD') >= TO_DATE(#{startDate},
			'YYYY-MM-DD')]]>
			</if>
			<if test="endDate != null and endDate != ''">
				AND TO_DATE(birth, 'YYYY-MM-DD') &lt;= TO_DATE(#{endDate},
			'YYYY-MM-DD')
			</if>
		</if>
		<if test="gender != null and gender != ''">
			AND gender = #{gender}
		</if>
	</select>
		
	<select id="findCustomerList" resultType="Customer">
		SELECT *
		FROM job_customer
	</select>
	
</mapper>

	


